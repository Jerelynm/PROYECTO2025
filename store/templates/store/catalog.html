{% extends 'store/base.html' %}

{% block title %}Catálogo de Productos{% endblock %}

{% block content %}
<h2 class="h-center">Catálogo de Productos</h2>

<!-- Para mostrar un boton de buscar/ aca se utiliza js -->
<input type="text" id="searchInput" class="search" placeholder="Buscar producto...">


<!-- Para mostrar filtros -->
{% if selected_category %}
<p class="h-center"><strong>Categoría:</strong> {{ selected_category }}</p>
{% elif selected_brand %}
<p class="h-center"><strong>Marca:</strong> {{ selected_brand }}</p>
{% endif %}


<table class="table">
  <thead>
    <tr>
      <th>Producto</th>
      <th>Marca</th>
      <th>Categoría</th>
      <th>Precio (Q)</th>
      <th>Stock</th>
    </tr>
    </thead>
    <tbody>
    {% for p in products %}
        <tr onclick="window.location='{% url 'product_detail' p.slug %}'" style="cursor:pointer;">
      <td><a href="{% url 'product_detail' p.slug %}">{{ p.name }}</a></td>
      <td>{{ p.brand.name }}</td>
      <td>{{ p.category.name }}</td>
      <td>Q{{ p.price }}</td>
      <td>{{ p.stock }}</td>
    </tr>
    {% empty %}
        <tr><td colspan="5" class="h-center">No hay productos disponibles.</td></tr>
    {% endfor %}
    </tbody>
</table>

<!-- porción de cod js / para el buscador -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const input = document.getElementById("searchInput");
    const rows = document.querySelectorAll("tbody tr");

    input.addEventListener("keyup", function() {
        const query = input.value.toLowerCase();
        rows.forEach(row => {
            const text = row.innerText.toLowerCase();
            row.style.display = text.includes(query) ? "" : "none";
        });
    });
});
</script>
{% endblock %}